<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Networks – Starsim</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../user_guide/modules_demographics.html" rel="next">
<link href="../user_guide/modules_diseases.html" rel="prev">
<link href="..//assets/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-065a5179aebd64318d7ea99d77b64a9e.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-969ddfa49e00a70eb3423444dbc81f6c.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-065a5179aebd64318d7ea99d77b64a9e.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-93366e8fb675778b1d1303b86401c41b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-8057c89b6b57390836df940bcc67f706.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-93366e8fb675778b1d1303b86401c41b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SVDSQH04EM"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SVDSQH04EM', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../assets/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/starsim-logo.png" alt="" class="navbar-logo light-content">
    <img src="../assets/starsim-logo.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../whatsnew.html"> 
<span class="menu-text">What’s new</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../tutorials.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../user_guide.html"> 
<span class="menu-text">User guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../conduct.html"> 
<span class="menu-text">Code of conduct</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contributing.html"> 
<span class="menu-text">Contributing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../api/index.html"> 
<span class="menu-text">API reference</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/starsimhub/starsim" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="mailto:info@starsim.org" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope-at-fill"></i></a>
    <a href="https://starsim-idm.slack.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-slack"></i></a>
    <a href="https://starsim.org" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-globe"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><strong>User guide</strong></li><li class="breadcrumb-item"><a href="../user_guide/modules_diseases.html">Modules</a></li><li class="breadcrumb-item"><a href="../user_guide/modules_networks.html">Networks</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Home</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../whatsnew.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>What’s new</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../api/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>API reference</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Tutorials</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T1 - Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t2_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T2 - Building your model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t3_demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T3 - Demographics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t4_diseases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T4 - Diseases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t5_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T5 - Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/t6_interventions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T6 - Interventions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>User guide</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/intro_starsim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is Starsim?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/intro_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Starsim models</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Basic concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/basics_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/basics_sim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Sim object</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/basics_people.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">People, States, and Arrays</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/basics_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Parameters</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_diseases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diseases</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_networks.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demographics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_interventions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interventions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_analyzers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyzers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/modules_connectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Connectors</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Workflows</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/workflows_run.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple runs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/workflows_sir_calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reidentify known parameters for a simple SIR model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/workflows_calibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration using Optuna-Starsim integration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/workflows_deploy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deployment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/workflows_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Samples</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_indexing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Array indexing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random numbers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Profiling and debugging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../user_guide/advanced_nonstandard.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonstandard usage</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../conduct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Code of conduct</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contributing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Contributing</strong></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#transmission-routes-and-the-route-base-class" id="toc-transmission-routes-and-the-route-base-class" class="nav-link active" data-scroll-target="#transmission-routes-and-the-route-base-class">Transmission routes and the Route base class</a>
  <ul class="collapse">
  <li><a href="#route-hierarchy" id="toc-route-hierarchy" class="nav-link" data-scroll-target="#route-hierarchy">Route hierarchy</a></li>
  <li><a href="#how-transmission-works-via-routes" id="toc-how-transmission-works-via-routes" class="nav-link" data-scroll-target="#how-transmission-works-via-routes">How transmission works via routes</a></li>
  </ul></li>
  <li><a href="#network-architecture-overview" id="toc-network-architecture-overview" class="nav-link" data-scroll-target="#network-architecture-overview">Network architecture overview</a>
  <ul class="collapse">
  <li><a href="#key-network-components" id="toc-key-network-components" class="nav-link" data-scroll-target="#key-network-components">Key network components:</a></li>
  </ul></li>
  <li><a href="#comparison-of-networks" id="toc-comparison-of-networks" class="nav-link" data-scroll-target="#comparison-of-networks">Comparison of networks</a>
  <ul class="collapse">
  <li><a href="#base-classes" id="toc-base-classes" class="nav-link" data-scroll-target="#base-classes">Base classes</a></li>
  <li><a href="#contact-network-implementations" id="toc-contact-network-implementations" class="nav-link" data-scroll-target="#contact-network-implementations">Contact network implementations</a></li>
  <li><a href="#additional-example-contact-networks" id="toc-additional-example-contact-networks" class="nav-link" data-scroll-target="#additional-example-contact-networks">Additional example contact networks</a></li>
  <li><a href="#mixing-pool-classes" id="toc-mixing-pool-classes" class="nav-link" data-scroll-target="#mixing-pool-classes">Mixing pool classes</a></li>
  <li><a href="#choosing-the-right-network-type" id="toc-choosing-the-right-network-type" class="nav-link" data-scroll-target="#choosing-the-right-network-type">Choosing the right network type</a></li>
  </ul></li>
  <li><a href="#core-implementation-methods" id="toc-core-implementation-methods" class="nav-link" data-scroll-target="#core-implementation-methods">Core implementation methods</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/starsimhub/starsim/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><strong>User guide</strong></li><li class="breadcrumb-item"><a href="../user_guide/modules_diseases.html">Modules</a></li><li class="breadcrumb-item"><a href="../user_guide/modules_networks.html">Networks</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This guide provides technical reference for implementing and customizing networks in Starsim. For learning-oriented examples, see the Networks tutorial.</p>
<section id="transmission-routes-and-the-route-base-class" class="level2">
<h2 class="anchored" data-anchor-id="transmission-routes-and-the-route-base-class">Transmission routes and the Route base class</h2>
<p>All disease transmission in Starsim occurs via <strong>routes</strong> - pathways through which infectious agents can spread. Both contact networks and mixing pools inherit from the base <a href="../api/networks.html#starsim.networks.Route" title="0"><code>ss.Route</code></a> class, which defines the interface for transmission mechanisms.</p>
<section id="route-hierarchy" class="level3">
<h3 class="anchored" data-anchor-id="route-hierarchy">Route hierarchy</h3>
<pre><code>ss.Route (base class for all transmission pathways)
├── ss.Network (contact-based transmission)
│   └── ss.DynamicNetwork (time-varying connections)
│       └── ss.SexualNetwork (sexual partnership networks)
└── ss.MixingPool (group-based transmission)</code></pre>
<p>When diseases calculate transmission, they iterate through all routes in the simulation and call each route’s transmission methods. This unified interface allows diseases to work seamlessly with any combination of networks and mixing pools.</p>
</section>
<section id="how-transmission-works-via-routes" class="level3">
<h3 class="anchored" data-anchor-id="how-transmission-works-via-routes">How transmission works via routes</h3>
<ol type="1">
<li><strong>Disease calls route</strong>: Each disease loops through <code>sim.networks</code> (which contains all routes)</li>
<li><strong>Route calculates transmission</strong>: Each route computes new infections based on its transmission model</li>
<li><strong>Route returns new cases</strong>: UIDs of newly infected agents are returned to the disease</li>
<li><strong>Disease processes infections</strong>: The disease handles state changes and prognoses for new cases</li>
</ol>
<p>This separation allows you to mix and match different transmission mechanisms in a single simulation.</p>
</section>
</section>
<section id="network-architecture-overview" class="level2">
<h2 class="anchored" data-anchor-id="network-architecture-overview">Network architecture overview</h2>
<p>Contact networks inherit from <a href="../api/networks.html#starsim.networks.Network" title="0"><code>ss.Network</code></a> and manage collections of edges (connections between agents). All networks must implement methods for creating, updating, and removing connections between agents.</p>
<section id="key-network-components" class="level3">
<h3 class="anchored" data-anchor-id="key-network-components">Key network components:</h3>
<ul>
<li><strong>Edges</strong>: The fundamental unit - connections between two agents with transmission parameters</li>
<li><strong>Parameters</strong>: Network-specific settings that control connection behavior</li>
<li><strong>State management</strong>: Tracking which agents can form connections</li>
<li><strong>Update methods</strong>: Logic for adding/removing connections over time</li>
</ul>
</section>
</section>
<section id="comparison-of-networks" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-networks">Comparison of networks</h2>
<p>Starsim provides different network types for different transmission scenarios:</p>
<section id="base-classes" class="level3">
<h3 class="anchored" data-anchor-id="base-classes">Base classes</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Class</th>
<th>Purpose</th>
<th>Key Features</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.Route" title="0"><code>Route</code></a></td>
<td>Base for all transmission pathways</td>
<td>Defines transmission interface</td>
<td>Never directly - inherit from this</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.Network" title="0"><code>Network</code></a></td>
<td>Base contact network</td>
<td>Edge management, validation</td>
<td>Rarely - use concrete classes</td>
</tr>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.DynamicNetwork" title="0"><code>DynamicNetwork</code></a></td>
<td>Time-varying connections</td>
<td>Adds/removes edges over time</td>
<td>When relationships form/dissolve</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.SexualNetwork" title="0"><code>SexualNetwork</code></a></td>
<td>Sexual partnerships</td>
<td>Age of debut, acts per partnership</td>
<td>For STI modeling</td>
</tr>
</tbody>
</table>
</section>
<section id="contact-network-implementations" class="level3">
<h3 class="anchored" data-anchor-id="contact-network-implementations">Contact network implementations</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Class</th>
<th>Purpose</th>
<th>Parameters</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.StaticNet" title="0"><code>StaticNet</code></a></td>
<td>NetworkX graph conversion</td>
<td><code>graph</code>, <code>p</code>, <code>n_contacts</code></td>
<td>Pre-defined network structures</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.RandomNet" title="0"><code>RandomNet</code></a></td>
<td>Random connections</td>
<td><code>n_contacts</code>, <a href="../api/time.html#starsim.time.dur" title="0"><code>dur</code></a></td>
<td>General infectious diseases</td>
</tr>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.MFNet" title="0"><code>MFNet</code></a></td>
<td>Male-female partnerships</td>
<td><code>duration</code>, <code>acts</code>, <code>debut</code></td>
<td>Heterosexual STI transmission</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.MSMNet" title="0"><code>MSMNet</code></a></td>
<td>Male-male partnerships</td>
<td><code>duration</code>, <code>acts</code>, <code>participation</code></td>
<td>MSM STI transmission</td>
</tr>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.MaternalNet" title="0"><code>MaternalNet</code></a></td>
<td>Mother-child (base)</td>
<td><a href="../api/time.html#starsim.time.dur" title="0"><code>dur</code></a>, <code>start</code>, <code>end</code></td>
<td>Vertical transmission</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.PrenatalNet" title="0"><code>PrenatalNet</code></a></td>
<td>Prenatal transmission</td>
<td>Inherits from MaternalNet</td>
<td>In-utero transmission</td>
</tr>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.PostnatalNet" title="0"><code>PostnatalNet</code></a></td>
<td>Postnatal transmission</td>
<td>Inherits from MaternalNet</td>
<td>Breastfeeding, birth canal</td>
</tr>
</tbody>
</table>
</section>
<section id="additional-example-contact-networks" class="level3">
<h3 class="anchored" data-anchor-id="additional-example-contact-networks">Additional example contact networks</h3>
<p><em>Note: these are available in the <code>starsim_examples</code> module.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Class</th>
<th>Purpose</th>
<th>Parameters</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ErdosRenyiNet</code></td>
<td>Probabilistic edges</td>
<td><code>p</code> (edge probability), <a href="../api/time.html#starsim.time.dur" title="0"><code>dur</code></a></td>
<td>Theoretical network studies</td>
</tr>
<tr class="even">
<td><code>DiskNet</code></td>
<td>Spatial proximity</td>
<td><code>r</code> (radius), <code>v</code> (velocity)</td>
<td>Geographic transmission</td>
</tr>
<tr class="odd">
<td><code>NullNet</code></td>
<td>Self-connections only</td>
<td><code>n_people</code></td>
<td>Debugging, placeholders</td>
</tr>
<tr class="even">
<td><code>EmbeddingNet</code></td>
<td>Age-assortative MF</td>
<td><code>male_shift</code>, <code>embedding_func</code></td>
<td>Age-structured STI modeling</td>
</tr>
</tbody>
</table>
</section>
<section id="mixing-pool-classes" class="level3">
<h3 class="anchored" data-anchor-id="mixing-pool-classes">Mixing pool classes</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Class</th>
<th>Purpose</th>
<th>Parameters</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.AgeGroup" title="0"><code>AgeGroup</code></a></td>
<td>Age-based filtering</td>
<td><code>low</code>, <code>high</code></td>
<td>Defining age groups for mixing</td>
</tr>
<tr class="even">
<td><a href="../api/networks.html#starsim.networks.MixingPool" title="0"><code>MixingPool</code></a></td>
<td>Single group transmission</td>
<td><code>src</code>, <code>dst</code>, <code>beta</code>, <code>contacts</code></td>
<td>Simple group-to-group mixing</td>
</tr>
<tr class="odd">
<td><a href="../api/networks.html#starsim.networks.MixingPools" title="0"><code>MixingPools</code></a></td>
<td>Multi-group mixing</td>
<td><code>src</code>, <code>dst</code>, <code>contacts</code> (matrix)</td>
<td>Complex age/risk structured mixing</td>
</tr>
</tbody>
</table>
</section>
<section id="choosing-the-right-network-type" class="level3">
<h3 class="anchored" data-anchor-id="choosing-the-right-network-type">Choosing the right network type</h3>
<ul>
<li><strong>For respiratory diseases (flu, COVID-19, measles):</strong>
<ul>
<li><a href="../api/networks.html#starsim.networks.RandomNet" title="0"><code>RandomNet</code></a>: Simple random mixing; the default in most cases</li>
<li><a href="../api/networks.html#starsim.networks.MixingPools" title="0"><code>MixingPools</code></a>: Age-structured mixing with contact matrices</li>
</ul></li>
<li><strong>For sexually transmitted infections:</strong>
<ul>
<li><a href="../api/networks.html#starsim.networks.MFNet" title="0"><code>MFNet</code></a>: Male-female (heterosexual) transmission</li>
<li><a href="../api/networks.html#starsim.networks.MSMNet" title="0"><code>MSMNet</code></a>: Transmission between men who have sex with men (MSM)</li>
<li><code>EmbeddingNet</code>: Age-assortative heterosexual mixing</li>
</ul></li>
<li><strong>For mother-to-child transmission:</strong>
<ul>
<li><a href="../api/networks.html#starsim.networks.PrenatalNet" title="0"><code>PrenatalNet</code></a>: In-utero transmission (HIV, syphilis)</li>
<li><a href="../api/networks.html#starsim.networks.PostnatalNet" title="0"><code>PostnatalNet</code></a>: Birth/breastfeeding transmission (HIV, HBV)</li>
</ul></li>
<li><strong>For special purposes:</strong>
<ul>
<li><a href="../api/networks.html#starsim.networks.StaticNet" title="0"><code>StaticNet</code></a>: Use existing NetworkX graphs</li>
<li><code>DiskNet</code>: Proof-of-concept spatial/geographic transmission<br>
</li>
<li><code>NullNet</code>: Testing/debugging without transmission</li>
<li><code>ErdosRenyiNet</code>: Theoretical network analysis</li>
</ul></li>
</ul>
</section>
</section>
<section id="core-implementation-methods" class="level2">
<h2 class="anchored" data-anchor-id="core-implementation-methods">Core implementation methods</h2>
<p>All networks inherit key methods from the base classes. Override these to create custom network behavior:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Method</th>
<th>Purpose</th>
<th>When to override</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>__init__()</code></td>
<td>Initialize parameters and state</td>
<td>Always for custom networks</td>
</tr>
<tr class="even">
<td><code>init_pre()</code></td>
<td>Pre-simulation initialization</td>
<td>Rarely</td>
</tr>
<tr class="odd">
<td><code>init_post()</code></td>
<td>Post-simulation initialization</td>
<td>When you need access to people</td>
</tr>
<tr class="even">
<td><code>add_pairs()</code></td>
<td>Create new connections</td>
<td>Key method for custom logic</td>
</tr>
<tr class="odd">
<td><code>remove_pairs()</code></td>
<td>Remove existing connections</td>
<td>For dynamic networks</td>
</tr>
<tr class="even">
<td><code>update()</code></td>
<td>Main update method each timestep</td>
<td>Rarely - calls add/remove pairs</td>
</tr>
<tr class="odd">
<td><a href="../api/utils.html#starsim.utils.find_contacts" title="0"><code>find_contacts()</code></a></td>
<td>Query network connections</td>
<td>Override for custom queries</td>
</tr>
</tbody>
</table>
<p>Let’s compare a simple SIR model configured with transmission using a single Mixing Pool to a similar model using a contact network. Mixing pools are not the same as contact networks, so the results are not expected to be identical.</p>
<div id="0fe5b776" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> starsim <span class="im">as</span> ss</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transmission using a mixing pool</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mp <span class="op">=</span> ss.MixingPool(beta<span class="op">=</span><span class="fl">1.0</span>, n_contacts<span class="op">=</span>ss.poisson(lam<span class="op">=</span><span class="dv">3</span>)) <span class="co"># A single mixing pool</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sir <span class="op">=</span> ss.SIR()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>sim1 <span class="op">=</span> ss.Sim(diseases<span class="op">=</span>sir, networks<span class="op">=</span>mp, verbose<span class="op">=</span><span class="dv">0</span>, label<span class="op">=</span><span class="st">'Mixing Pool'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transmission using a network</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> ss.RandomNet(n_contacts<span class="op">=</span>ss.poisson(lam<span class="op">=</span><span class="dv">3</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>sir <span class="op">=</span> ss.SIR()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>sim2 <span class="op">=</span> ss.Sim(diseases<span class="op">=</span>sir, networks<span class="op">=</span>net, verbose<span class="op">=</span><span class="dv">0</span>, label<span class="op">=</span><span class="st">'Contact Network'</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>msim <span class="op">=</span> ss.MultiSim([sim1, sim2]).run()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>msim.plot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Exception ignored in: &lt;_io.BytesIO object at 0x7f4a56d3fe70&gt;
Traceback (most recent call last):
  File "/home/runner/work/starsim/starsim/starsim/time.py", line 336, in to_year
    year_start = pd.Timestamp(year=self.year,month=1,day=1).timestamp()
BufferError: Existing exports of data: object cannot be re-sized</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Figure(768x576)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modules_networks_files/figure-html/cell-2-output-3.png" width="759" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Each MixingPool has several configuration parameters, including <code>src</code> and <code>dst</code>. The value of these parameters can either be an array of uids, like <code>ss.uids([0,1,2])</code> or a callable function that takes <a href="../api/sim.html#starsim.sim" title="0"><code>sim</code></a> as an argument and returns an array of uids (or a BoolArr) like <code>lambda sim: sim.people.age&lt;10</code>. One helper class we have created is called <a href="../api/networks.html#starsim.networks.AgeGroup" title="0"><code>AgeGroup</code></a>, which takes <code>low</code> and <code>high</code> ages as parameters. This class has some performance advantages when using multiple pools via <a href="../api/networks.html#starsim.networks.MixingPools" title="0"><code>MixingPools</code></a> through caching.</p>
<p>While mixing pools do not represent individual agent-to-agent connections, each agent does have an “effective” number of contacts, typically drawn from a Poisson distribution. Individuals retain their number of contacts within each pool for the duration of the simulation. Effective contacts are used on the acquisition sides. On the transmission side, the “average” infection level, called <code>trans</code>, against which susceptible agents are challenged is computed as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>trans <span class="op">=</span> np.mean(disease.infectious[<span class="va">self</span>.src_uids] <span class="op">*</span> disease.rel_trans[<span class="va">self</span>.src_uids])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>And on the acquisition side, each susceptible agent can be thought of as connected to <code>eff_contacts</code> average infectious agents, computed as:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>acq <span class="op">=</span> <span class="va">self</span>.eff_contacts[<span class="va">self</span>.dst_uids] <span class="op">*</span> disease.susceptible[<span class="va">self</span>.dst_uids] <span class="op">*</span> disease.rel_sus[<span class="va">self</span>.dst_uids]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Ultimately, the acquisition probability for each susceptible agent in <code>dst_uids</code> is computed as</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="va">self</span>.pars.beta <span class="op">*</span> trans <span class="op">*</span> acq</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>You can see the <code>beta</code> parameter here, which is another pool parameter and should use <code>ss.timeprob()</code> to automatically adjust for time units. Mixing pools do not currently use the <code>beta</code> parameters configured in individual disease modules.</p>
<div id="e98e700a" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mp <span class="op">=</span> ss.MixingPool(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    diseases <span class="op">=</span> <span class="st">'sir'</span>, <span class="co"># Use this pool only for SIR, not other diseases (HIV in this example)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    src <span class="op">=</span> <span class="kw">lambda</span> sim: sim.people.age <span class="op">&lt;</span> <span class="dv">15</span>, <span class="co"># Infection sources will be agents under age 15</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> ss.AgeGroup(low<span class="op">=</span><span class="dv">15</span>, high<span class="op">=</span><span class="va">None</span>), <span class="co"># Here demonstrating the AgeGroup class, identical to lambda sim: sim.people.age &gt;= 15</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    n_contacts <span class="op">=</span> ss.poisson(lam<span class="op">=</span><span class="dv">5</span>), <span class="co"># Contacts will be poisson distributed with a mean of 5</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>sim <span class="op">=</span> ss.Sim(diseases<span class="op">=</span>[<span class="st">'sir'</span>, <span class="st">'sis'</span>], networks<span class="op">=</span>mp) <span class="co"># Two diseases, but only "sir" will have transmission</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>sim.run()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>sim.plot()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initializing sim with 10000 agents
  Running 2000.01.01 ( 0/51) (0.00 s)  ———————————————————— 2%
  Running 2010.01.01 (10/51) (0.03 s)  ••••———————————————— 22%
  Running 2020.01.01 (20/51) (0.04 s)  ••••••••———————————— 41%
  Running 2030.01.01 (30/51) (0.06 s)  ••••••••••••———————— 61%
  Running 2040.01.01 (40/51) (0.08 s)  ••••••••••••••••———— 80%
  Running 2050.01.01 (50/51) (0.10 s)  •••••••••••••••••••• 100%

Figure(896x672)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modules_networks_files/figure-html/cell-3-output-2.png" width="886" height="662" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><a href="../api/networks.html#starsim.networks.MixingPools" title="0"><code>MixingPools</code></a> (plural) allows you to configure multiple individual <a href="../api/networks.html#starsim.networks.MixingPool" title="0"><code>MixingPool</code></a> pools. This first example shows how to do age mixing. Like <a href="../api/networks.html#starsim.networks.MixingPool" title="0"><code>MixingPool</code></a>, <a href="../api/networks.html#starsim.networks.MixingPools" title="0"><code>MixingPools</code></a> also takes <code>src</code> and <code>dst</code>, however each of these parameters must be a dictionary with key specifying the name of each group and value as in the singlular mixing pool proving the uids by a callable function or list of uids.</p>
<div id="c4037c42" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sciris <span class="im">as</span> sc</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>bin_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>lows <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">80</span>, bin_size)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>highs <span class="op">=</span> sc.cat(lows[<span class="dv">1</span>:], <span class="dv">100</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> ss.ndict([ss.AgeGroup(low<span class="op">=</span>low, high<span class="op">=</span>high) <span class="cf">for</span> low, high <span class="kw">in</span> <span class="bu">zip</span>(lows, highs)])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>n_groups <span class="op">=</span> <span class="bu">len</span>(groups)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's create a random contact matrix. If using contact matrices from Prem et al., put data here.</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> np.random.random((n_groups, n_groups)) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>np.diag(np.random.rand(n_groups))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The first axis (rows) of the contact matrix is the SOURCE group'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The second axis (columns) of the contact matrix is the DESTINATION group'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plt.imshow(cm)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>mps <span class="op">=</span> ss.MixingPools(</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    n_contacts <span class="op">=</span> cm,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    src <span class="op">=</span> groups,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> groups,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Track new infections by age using an Analyzer, you'll learn about these in a subsequent tutorial</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> InfectionsByAge(ss.Analyzer):</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, bins, <span class="op">**</span>kwargs):</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.bins <span class="op">=</span> bins</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.update_pars(<span class="op">**</span>kwargs)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_post(<span class="va">self</span>):</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().init_post()</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.new_cases <span class="op">=</span> np.zeros((<span class="bu">len</span>(<span class="va">self</span>), <span class="bu">len</span>(<span class="va">self</span>.bins)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        new_inf <span class="op">=</span> <span class="va">self</span>.sim.diseases.sir.ti_infected <span class="op">==</span> <span class="va">self</span>.ti</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> new_inf.<span class="bu">any</span>(): <span class="cf">return</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.new_cases[<span class="va">self</span>.ti, :] <span class="op">=</span> np.histogram(<span class="va">self</span>.sim.people.age[new_inf], bins<span class="op">=</span><span class="va">self</span>.bins)[<span class="dv">0</span>]</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> plot(<span class="va">self</span>):</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        ax.set_prop_cycle(<span class="st">'color'</span>, plt.cm.nipy_spectral(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(<span class="va">self</span>.bins))))</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, (b1, b2) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(<span class="va">self</span>.bins[:<span class="op">-</span><span class="dv">1</span>], <span class="va">self</span>.bins[<span class="dv">1</span>:])):</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>            ax.plot(<span class="va">self</span>.timevec, <span class="va">self</span>.new_cases[:,i], label<span class="op">=</span><span class="ss">f'Age </span><span class="sc">{</span>b1<span class="sc">}</span><span class="ss">-</span><span class="sc">{</span>b2<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        ax.legend()<span class="op">;</span> ax.set_xlabel(<span class="st">'Year'</span>)<span class="op">;</span> ax.set_ylabel(<span class="st">'New Infections'</span>)</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>az <span class="op">=</span> InfectionsByAge(np.concatenate([lows, [<span class="dv">1000</span>]]))</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>sir <span class="op">=</span> ss.SIR()</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>sim <span class="op">=</span> ss.Sim(diseases<span class="op">=</span>sir, networks<span class="op">=</span>mps, analyzers<span class="op">=</span>az, dur<span class="op">=</span><span class="dv">5</span>, dt<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, n_agents<span class="op">=</span><span class="dv">1000</span>, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>sim.run()</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>sim.analyzers[<span class="dv">0</span>].plot()</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'↑ The default age distribution is uniform, so the 75+ group contains many more people than the other age groups, explaining the larger number of new infections.'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>The first axis (rows) of the contact matrix is the SOURCE group
The second axis (columns) of the contact matrix is the DESTINATION group
↑ The default age distribution is uniform, so the 75+ group contains many more people than the other age groups, explaining the larger number of new infections.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modules_networks_files/figure-html/cell-4-output-2.png" width="415" height="411" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modules_networks_files/figure-html/cell-4-output-3.png" width="576" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Mixing pools work well with properties other than age. Here’s an example that mixes by socio-economic status (SES).</p>
<div id="291469a2" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define SES states</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ses <span class="op">=</span> sc.objdict(low<span class="op">=</span><span class="dv">0</span>, mid<span class="op">=</span><span class="dv">1</span>, high<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 5,000 people adding 50% LOW, 30% MID, and 20% HIGH SES</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ses_arr <span class="op">=</span> ss.FloatArr(<span class="st">'ses'</span>, default<span class="op">=</span>ss.choice(a<span class="op">=</span>ses.values(), p<span class="op">=</span>[<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>]))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ppl <span class="op">=</span> ss.People(n_agents<span class="op">=</span><span class="dv">5_000</span>, extra_states<span class="op">=</span>ses_arr)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the mixing pools, note that the contact matrix need not be symmetric</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>mps <span class="op">=</span> ss.MixingPools(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    src <span class="op">=</span> {k: <span class="kw">lambda</span> sim, s<span class="op">=</span>v: ss.uids(sim.people.ses <span class="op">==</span> s) <span class="cf">for</span> k,v <span class="kw">in</span> ses.items()},</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> {k: <span class="kw">lambda</span> sim, s<span class="op">=</span>v: ss.uids(sim.people.ses <span class="op">==</span> s) <span class="cf">for</span> k,v <span class="kw">in</span> ses.items()[:<span class="op">-</span><span class="dv">1</span>]}, <span class="co"># People in the HIGH group have no route to acquire new infections, for demonstration purposes here</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># src on rows (1st dimension), dst on cols (2nd dimension)</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    n_contacts <span class="op">=</span> np.array([</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">2.50</span>, <span class="fl">0.00</span>], <span class="co"># low→low,  low→mid</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.05</span>, <span class="fl">1.75</span>], <span class="co"># mid→low,  mid→mid</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.00</span>, <span class="fl">0.15</span>], <span class="co"># high→low, high→mid</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    ]),</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an analyzer to track results by SES group</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> New_Infections_By_SES(ss.Analyzer):</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> init_results(<span class="va">self</span>):</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().init_results()</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.new_cases <span class="op">=</span> np.zeros((<span class="bu">len</span>(<span class="va">self</span>), <span class="bu">len</span>(ses)))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        new_inf <span class="op">=</span> <span class="va">self</span>.sim.diseases.sir.ti_infected <span class="op">==</span> <span class="va">self</span>.ti</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> new_inf.<span class="bu">any</span>():</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> value <span class="kw">in</span> ses.values():</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.new_cases[<span class="va">self</span>.ti, value] <span class="op">=</span> np.count_nonzero(new_inf <span class="op">&amp;</span> (<span class="va">self</span>.sim.people.ses<span class="op">==</span>value))</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>az <span class="op">=</span> New_Infections_By_SES()</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> seeding(<span class="va">self</span>, sim, uids):</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> np.zeros(<span class="bu">len</span>(uids))</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    high_ses <span class="op">=</span> ss.uids(sim.people.ses <span class="op">==</span> ses.high)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    p[high_ses] <span class="op">=</span> <span class="fl">0.1</span> <span class="co"># Seed infections into 10% of SES HIGH</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>sir <span class="op">=</span> ss.SIR(init_prev <span class="op">=</span> ss.bernoulli(p<span class="op">=</span>seeding), beta<span class="op">=</span>ss.peryear(<span class="fl">0.2</span>)) <span class="co"># The probability of being selected as a seed is determined on a per-agent basis by the above 'seeding' function</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>sim <span class="op">=</span> ss.Sim(people<span class="op">=</span>ppl, diseases<span class="op">=</span>sir, networks<span class="op">=</span>mps, analyzers<span class="op">=</span>az, dt<span class="op">=</span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>, dur<span class="op">=</span><span class="dv">35</span>, verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>sim.run()</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>new_cases <span class="op">=</span> sim.analyzers[<span class="dv">0</span>].new_cases</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key,value <span class="kw">in</span> ses.items():</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    ax.plot(sim.results.timevec, new_cases[:,value], label<span class="op">=</span>key)</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'New Infections'</span>)</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modules_networks_files/figure-html/cell-5-output-1.png" width="600" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In the above figure, infections are seeded into the high group at the beginning of the simulation, explaining the spike in new cases at that time. High SES can only infect mid SES, so the mid (orange) wave follows. Low SES can only become infected by mid SES in this example, so the blue wave follows. This example intentionally demonstrates the directional nature of mixing pools and includes strong mixing within groups and bottlenecks between groups to make the point.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../user_guide/modules_diseases.html" class="pagination-link" aria-label="Diseases">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Diseases</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../user_guide/modules_demographics.html" class="pagination-link" aria-label="Demographics">
        <span class="nav-page-text">Demographics</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>The docs were built for Starsim v3.0.4 (2025-10-22).<br>© 2023–2025, Gates Foundation. All rights reserved. <a href="https://www.gatesfoundation.org/Privacy-and-Cookies-Notice">Privacy and Cookies Notice</a> | <a href="https://www.gatesfoundation.org/Terms-of-Use">Terms of Use</a></p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/starsimhub/starsim/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/starsimhub/starsim">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:info@starsim.org">
      <i class="bi bi-envelope-at-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://starsim.org/">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>